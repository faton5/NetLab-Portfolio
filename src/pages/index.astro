---
import BaseLayout from "../layouts/BaseLayout.astro";
import ProjectCard from "../components/ProjectCard.astro";
import { getCollection } from "astro:content";
import siteData from "../data/site.json";
import certifications from "../data/certifications.json";

const featuredProjects = await getCollection(
  "projects",
  ({ data }) => data.featured
);

// Stats pour la section
const allProjects = await getCollection("projects");
const stats = {
  projects: allProjects.length,
  experience: "22+ semaines",
  platforms: 3,
};

// Status labels for certifications
const certStatusLabels: Record<string, { label: string; class: string }> = {
  completed: { label: "‚úÖ Obtenu", class: "cert-completed" },
  in_progress: { label: "üî® En cours", class: "cert-progress" },
  planned: { label: "üìã Pr√©vu", class: "cert-planned" },
};
---

<BaseLayout
  title={`${siteData.name} | ${siteData.title}`}
  description={siteData.description}
>
  <section class="hero">
    <div class="container">
      <div class="hero-content">
        <span class="hero-subtitle">üëã Bienvenue sur mon portfolio</span>
        <h1 class="hero-title">
          Je suis <span class="accent">{siteData.name}</span>,<br />
          {siteData.title}
        </h1>
        <p class="hero-description">
          {siteData.description}
        </p>

        <div class="hero-ctas">
          <a href={siteData.links.cv} class="btn btn-primary" target="_blank">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="18"
              height="18"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path
                d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"
              ></path>
              <polyline points="14 2 14 8 20 8"></polyline>
              <line x1="16" y1="13" x2="8" y2="13"></line>
              <line x1="16" y1="17" x2="8" y2="17"></line>
            </svg>
            T√©l√©charger mon CV
          </a>
        </div>
      </div>
    </div>
  </section>

  <!-- Section Stats -->
  <section class="section stats-section">
    <div class="container">
      <div class="stats-grid">
        <div class="stat-card">
          <span class="stat-number">{stats.projects}</span>
          <span class="stat-label">Projets</span>
        </div>
        <div class="stat-card">
          <span class="stat-number">{stats.experience}</span>
          <span class="stat-label">Stage</span>
        </div>
        <div class="stat-card">
          <span class="stat-number">{stats.platforms}</span>
          <span class="stat-label">Plateformes CTF</span>
        </div>
      </div>
    </div>
  </section>

  <!-- Section Projets Phares (d√©plac√©e en premier) -->
  {
    featuredProjects.length > 0 && (
      <section class="section">
        <div class="container">
          <h2 class="section-title">üöÄ Projets Phares</h2>
          <div class="featured-grid">
            {featuredProjects.slice(0, 3).map((project) => (
              <ProjectCard
                title={project.data.title}
                description={project.data.description}
                summary={project.data.summary}
                category={project.data.category}
                type={project.data.type}
                image={project.data.image}
                tags={project.data.tags}
                slug={project.slug}
                featured={true}
                status={project.data.status}
              />
            ))}
          </div>
          <div style="text-align: center; margin-top: 2rem;">
            <a href="/projets" class="btn btn-secondary">
              Voir tous les projets ‚Üí
            </a>
          </div>
        </div>
      </section>
    )
  }

  <!-- Section Certifications (pr√©vues) -->
  <section class="section">
    <div class="container">
      <h2 class="section-title">üìú Certifications & Formations</h2>
      <p
        style="text-align: center; color: var(--text-secondary); margin-bottom: 2rem;"
      >
        Certifications pr√©vues pour 2025
      </p>
      <div class="certifications-grid">
        {
          certifications.map((cert) => (
            <div class="cert-card">
              <div class="cert-icon">{cert.icon}</div>
              <h3>{cert.name}</h3>
              <p>{cert.description}</p>
              <div class="cert-footer">
                <span
                  class={`cert-status ${certStatusLabels[cert.status]?.class || ""}`}
                >
                  {certStatusLabels[cert.status]?.label || cert.status}
                </span>
                <span class="cert-year">{cert.year}</span>
              </div>
            </div>
          ))
        }
      </div>
    </div>
  </section>

  <!-- Section Plateformes CTF -->
  <section class="section">
    <div class="container">
      <h2 class="section-title">üéØ Plateformes Cybers√©curit√©</h2>
      <p
        style="text-align: center; color: var(--text-secondary); margin-bottom: 2rem;"
      >
        Entra√Ænement actif sur les principales plateformes CTF
      </p>
      <div class="platforms-grid">
        <a
          href={siteData.links.tryhackme}
          target="_blank"
          rel="noopener noreferrer"
          class="platform-card"
        >
          <div class="platform-icon">üè¥‚Äç‚ò†Ô∏è</div>
          <h3>TryHackMe</h3>
          <p>Apprentissage guid√©</p>
          <span class="platform-username">@faton</span>
        </a>
        <a
          href={siteData.links.rootme}
          target="_blank"
          rel="noopener noreferrer"
          class="platform-card"
        >
          <div class="platform-icon">üåê</div>
          <h3>Root-Me</h3>
          <p>Challenges vari√©s</p>
          <span class="platform-username">@faton</span>
        </a>
        <a
          href={siteData.links.hackthebox}
          target="_blank"
          rel="noopener noreferrer"
          class="platform-card"
        >
          <div class="platform-icon">üì¶</div>
          <h3>HackTheBox</h3>
          <p>Labs r√©alistes</p>
          <span class="platform-username">@faton</span>
        </a>
      </div>
    </div>
  </section>

  <!-- Section √Ä Propos rapide -->
  <section class="section about-section">
    <div class="container">
      <div class="about-grid">
        <div class="about-content">
          <h2 class="section-title" style="text-align: left;">üí° Mon Profil</h2>
          <p>
            √âtudiant de <strong>18 ans</strong> en <strong
              >Bachelor Informatique</strong
            > √† Sup de Vinci, passionn√© par les <strong
              >syst√®mes, r√©seaux et la cybers√©curit√©</strong
            >.
          </p>
          <p>
            Avec plus de <strong>22 semaines de stage</strong> en entreprise, j'ai
            acquis une exp√©rience concr√®te en administration Active Directory, d√©ploiement
            de serveurs RDP/TSE, et gestion GLPI.
          </p>
          <p>
            <strong>√âtudiant entrepreneur</strong> via "Fabrik ta P√©pite", je d√©veloppe
            mon autonomie et mon esprit d'initiative au quotidien.
          </p>
          <div style="margin-top: 1.5rem;">
            <a href="/experience" class="btn btn-secondary"
              >Voir mon parcours ‚Üí</a
            >
          </div>
        </div>
        <div class="about-skills">
          <h3>Comp√©tences Techniques</h3>
          <div class="skills-list">
            <span class="skill-tag">Windows Server</span>
            <span class="skill-tag">Linux</span>
            <span class="skill-tag">Active Directory</span>
            <span class="skill-tag">Virtualisation</span>
            <span class="skill-tag">R√©seau</span>
            <span class="skill-tag">Cybers√©curit√©</span>
            <span class="skill-tag">GLPI</span>
            <span class="skill-tag">Docker</span>
          </div>
        </div>
      </div>
    </div>
  </section>
</BaseLayout>

<style>
  .hero-info {
    display: flex;
    gap: 1rem;
    margin-bottom: 1rem;
    flex-wrap: wrap;
  }

  .info-badge {
    padding: 0.5rem 1rem;
    background: var(--bg-tertiary);
    border-radius: var(--radius-full);
    font-size: 0.875rem;
    color: var(--text-secondary);
    border: 1px solid var(--border);
  }

  /* Stats Section */
  .stats-section {
    padding: 2rem 0;
    background: var(--bg-secondary);
  }

  .stats-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 2rem;
    text-align: center;
  }

  .stat-card {
    padding: 1.5rem;
  }

  .stat-number {
    display: block;
    font-size: 2.5rem;
    font-weight: 700;
    color: var(--accent);
    line-height: 1;
  }

  .stat-label {
    display: block;
    margin-top: 0.5rem;
    color: var(--text-secondary);
    font-size: 0.9rem;
  }

  /* Platforms Grid */
  .platforms-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1.5rem;
  }

  .platform-card {
    padding: 2rem;
    background: var(--bg-secondary);
    border: 1px solid var(--border);
    border-radius: var(--radius-lg);
    text-align: center;
    text-decoration: none;
    color: inherit;
    transition: all var(--transition-base);
  }

  .platform-card:hover {
    border-color: var(--accent);
    transform: translateY(-4px);
  }

  .platform-icon {
    font-size: 3rem;
    margin-bottom: 1rem;
  }

  .platform-card h3 {
    margin-bottom: 0.5rem;
    color: var(--text-primary);
  }

  .platform-card p {
    color: var(--text-secondary);
    font-size: 0.875rem;
    margin-bottom: 0.5rem;
  }

  .platform-username {
    display: inline-block;
    padding: 0.25rem 0.75rem;
    background: var(--accent-glow);
    color: var(--accent);
    border-radius: var(--radius-full);
    font-size: 0.75rem;
    font-weight: 600;
  }

  /* About Section */
  .about-section {
    background: var(--bg-secondary);
  }

  .about-grid {
    display: grid;
    grid-template-columns: 1.5fr 1fr;
    gap: 4rem;
    align-items: start;
  }

  .about-content p {
    color: var(--text-secondary);
    margin-bottom: 1rem;
    line-height: 1.7;
  }

  .about-content strong {
    color: var(--text-primary);
  }

  .about-skills h3 {
    margin-bottom: 1rem;
    color: var(--text-primary);
  }

  .skills-list {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
  }

  .skill-tag {
    padding: 0.5rem 1rem;
    background: var(--bg-tertiary);
    border: 1px solid var(--border);
    border-radius: var(--radius-md);
    font-size: 0.875rem;
    color: var(--text-secondary);
    transition: all var(--transition-fast);
  }

  .skill-tag:hover {
    border-color: var(--accent);
    color: var(--accent);
  }

  /* Certifications Grid */
  .certifications-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 1.5rem;
  }

  .cert-card {
    padding: 1.5rem;
    background: var(--bg-secondary);
    border: 1px solid var(--border);
    border-radius: var(--radius-lg);
    text-align: center;
    transition: all var(--transition-base);
  }

  .cert-card:hover {
    border-color: var(--accent);
    transform: translateY(-4px);
  }

  .cert-icon {
    font-size: 2.5rem;
    margin-bottom: 1rem;
  }

  .cert-card h3 {
    margin-bottom: 0.5rem;
    color: var(--text-primary);
    font-size: 1rem;
  }

  .cert-card p {
    color: var(--text-secondary);
    font-size: 0.875rem;
    margin-bottom: 1rem;
  }

  .cert-footer {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 0.5rem;
  }

  .cert-status {
    padding: 0.25rem 0.5rem;
    font-size: 0.75rem;
    font-weight: 500;
    border-radius: var(--radius-sm);
  }

  .cert-completed {
    background: rgba(34, 197, 94, 0.15);
    color: #4ade80;
  }

  .cert-progress {
    background: rgba(245, 158, 11, 0.15);
    color: #fbbf24;
  }

  .cert-planned {
    background: rgba(59, 130, 246, 0.15);
    color: #60a5fa;
  }

  .cert-year {
    font-size: 0.75rem;
    color: var(--text-muted);
  }

  /* Responsive */
  @media (max-width: 768px) {
    .stats-grid {
      grid-template-columns: repeat(3, 1fr);
      gap: 1rem;
    }

    .stat-number {
      font-size: 1.75rem;
    }

    .platforms-grid {
      grid-template-columns: 1fr;
    }

    .about-grid {
      grid-template-columns: 1fr;
      gap: 2rem;
    }

    .hero-info {
      flex-direction: column;
      align-items: flex-start;
    }

    .certifications-grid {
      grid-template-columns: 1fr;
    }
  }
</style>
